<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Pluto is decentralized HTTP router designed on Internet Computer to allow users to create decentralized rest-api infrastructure.">
  <meta name="robots" content="index, follow">
  <meta property="og:title" content="Pluto - decentralized HTTP router">
  <meta property="og:url" content="https://t5mcf-cqaaa-aaaag-qcjna-cai.raw.icp0.io/">
  <meta property="og:description" content="Pluto is decentralized HTTP router designed on Internet Computer to allow users to create decentralized rest-api infrastructure.">
  <meta property="og:type" content="website">

  <link rel="stylesheet" href="/styles/style.css">
  <link rel="stylesheet" href="/styles/fonts.css">

 

  <title>Pluto - decentralized HTTP router</title>

  <script lang="js" src="js/smooth_scroll.js">
    
  </script>
<link rel="stylesheet" href="/_astro/SUMMARY.68b3370a.css" />
<link rel="stylesheet" href="/_astro/Minimap.a2345f3b.css" /></head>
  <body>
    
  <div class="container mx-auto">
    <nav class="mx-8 my-0 sm:my-4">
      <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var d;{let p={0:t=>u(t),1:t=>l(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(l(t)),5:t=>new Set(l(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},h=t=>{let[e,n]=t;return e in p?p[e](n):void 0},l=t=>t.map(h),u=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,h(n)]));customElements.get("astro-island")||customElements.define("astro-island",(d=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=async()=>{var i;if(!this.hydrator||!this.isConnected)return;let e=(i=this.parentElement)==null?void 0:i.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),o={},a=this.querySelectorAll("template[data-astro-template]");for(let r of a){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(o[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of n){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(o[r.getAttribute("name")||"default"]=r.innerHTML)}let c;try{c=this.hasAttribute("props")?u(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}await this.hydrator(this)(this.Component,c,o,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((e,n)=>{n.disconnect(),setTimeout(()=>this.childrenConnectedCallback(),0)}).observe(this,{childList:!0})}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}Astro[n](async()=>{let o=this.getAttribute("renderer-url"),[a,{default:c}]=await Promise.all([import(this.getAttribute("component-url")),o?import(o):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(let r of i.split("."))this.Component=this.Component[r]}return this.hydrator=c,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},d.observedAttributes=["props"],d))}})();</script><astro-island uid="7nuyM" component-url="/_astro/NavBar.5d5d8abf.js" component-export="default" renderer-url="/_astro/client.537fc49b.js" props="{&quot;searchData&quot;:[1,[[0,{&quot;title&quot;:[0,&quot;Advanced Topics&quot;],&quot;headings&quot;:[1,[]],&quot;url&quot;:[0,&quot;/docs/advanced&quot;]}],[0,{&quot;title&quot;:[0,&quot;Setting Up the Project&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;setting-up-the-project&quot;],&quot;text&quot;:[0,&quot;Setting up the project&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;server-setup&quot;],&quot;text&quot;:[0,&quot;Server setup&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/advanced/one&quot;]}],[0,{&quot;title&quot;:[0],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;getting-started&quot;],&quot;text&quot;:[0,&quot;Getting Started&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;tools-and-requirements&quot;],&quot;text&quot;:[0,&quot;Tools and Requirements&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;rust&quot;],&quot;text&quot;:[0,&quot;Rust&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;internet-computer-tooling&quot;],&quot;text&quot;:[0,&quot;Internet Computer tooling&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;other-requirements&quot;],&quot;text&quot;:[0,&quot;Other requirements&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/getting_started&quot;]}],[0,{&quot;title&quot;:[0,&quot;Running the Examples&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;core-features-of-pluto&quot;],&quot;text&quot;:[0,&quot;Core features of Pluto&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;cloning-the-repository&quot;],&quot;text&quot;:[0,&quot;Cloning the repository&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;accessing-the-canisters-through-http&quot;],&quot;text&quot;:[0,&quot;Accessing the canisters through HTTP&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/getting_started/runing_examples&quot;]}],[0,{&quot;title&quot;:[0],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;introduction&quot;],&quot;text&quot;:[0,&quot;Introduction&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;idea&quot;],&quot;text&quot;:[0,&quot;Idea&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;installation&quot;],&quot;text&quot;:[0,&quot;Installation&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cargotoml&quot;],&quot;text&quot;:[0,&quot;cargo.toml&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;librs&quot;],&quot;text&quot;:[0,&quot;lib.rs&quot;]}]]],&quot;url&quot;:[0,&quot;/docs&quot;]}],[0,{&quot;title&quot;:[0],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;overview&quot;],&quot;text&quot;:[0,&quot;Overview&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;input-methods&quot;],&quot;text&quot;:[0,&quot;Input methods:&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;routing&quot;],&quot;text&quot;:[0,&quot;Routing&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/overview&quot;]}],[0,{&quot;title&quot;:[0,&quot;Building REST APIs&quot;],&quot;headings&quot;:[1,[]],&quot;url&quot;:[0,&quot;/docs/rest_apis&quot;]}],[0,{&quot;title&quot;:[0,&quot;Setting Up the Project&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;setting-up-the-project&quot;],&quot;text&quot;:[0,&quot;Setting up the project&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;server-setup&quot;],&quot;text&quot;:[0,&quot;Server setup&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/rest_apis/one&quot;]}],[0,{&quot;title&quot;:[0,&quot;Adding CORS&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;bootstraping-cors&quot;],&quot;text&quot;:[0,&quot;Bootstraping CORS&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/rest_apis/three&quot;]}],[0,{&quot;title&quot;:[0,&quot;Adding Body Validation&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;adding-an-addition-endpoint&quot;],&quot;text&quot;:[0,&quot;Adding an addition endpoint&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/rest_apis/two&quot;]}]]]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;NavBar&quot;,&quot;value&quot;:true}"></astro-island>
    </nav>
    <section class="sm:flex">
      <section>
  <div class="sm:pl-1">
    <astro-island uid="Z1tixu1" component-url="/_astro/Menu.daa14378.js" component-export="default" renderer-url="/_astro/client.537fc49b.js" props="{&quot;summaryContent&quot;:[0,&quot;&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs\&quot; class=\&quot;text-greenAccent-500\&quot;&gt;INTRODUCTION&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/overview\&quot;&gt;OVERVIEW&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/getting_started\&quot;&gt;GETTING STARTED&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/getting_started/runing_examples.md\&quot;&gt;Running the Examples&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/\&quot;&gt;BUILDING REST APIS&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/one\&quot;&gt;Project Setup&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/two\&quot;&gt;Body Validation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/three\&quot;&gt;CORS support&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;&quot;]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Menu&quot;,&quot;value&quot;:true}"></astro-island>
  </div>
</section>
      <div class="docView grow md:p-2 lg:p-5 sm:px-2 md:px-5 lg:px-20 overflow-x-hidden">
        <h1></h1>
        <div class="docMargin min-h-screen ">
          <h1 id="introduction">Introduction</h1>
<p>Pluto (Plutonium) is a <a href="https://www.rust-lang.org/">Rust</a> framework for building efficient blockchain-side applications. This framework allows developers to create scalable REST-API servers as well as blockchain-side rendered websites.</p>
<p>Pluto provides a level of abstraction above <a href="https://internetcomputer.org/">Internet Computer</a> <a href="https://internetcomputer.org/how-it-works/smart-contracts-serve-the-web/#http-gateway-protocol">HTTP gateway protocol</a>. This allow developers to focus on building them own solutions without need of maintaining HTTP service infrastructure.</p>
<h2 id="idea">Idea</h2>
<p>While developing a NFT solution we find out that because of architecture of most of existing blockchain fetching data is only possible via them interface that is not flexible at all. Because of that we was looking for a way to store NFT metadata in decentralized way with possibility to edit them. Our first idea was to use <a href="https://www.arweave.org/">arweave</a> or <a href="https://ipfs.tech/">IPFS</a> but using sollution like one of this would make our app centralized because of payment gateway because to perform payment for storage wallet was needed. After much more research we find out that only Internet Computer may solve our problems.</p>
<p>At the time of building Pluto HTTP on Internet Computer was very raw thats why we decided to create a framework that will support HTTP out of the box with architecture that if familiar for most of web 2 developers. Developer experience was our first goal thats why we was trying to achieve developer experience like in these frameworks: <a href="https://nestjs.com/">NestJS</a>, <a href="https://expressjs.com/">ExpressJS</a>, <a href="https://rocket.rs/">Rocker</a></p>
<h2 id="installation">Installation</h2>
<p>To get started, you can create a new project using the <a href="https://internetcomputer.org/docs/current/references/cli-reference/">dfx CLI</a> and add a few configuration lines to the code of the canister, or clone our repo and play around with the examples.</p>
<p>To create a new project using the dfx CLI, run the following commands. The given commands will install and create a new project directory containing the code of the canister. The created canister isn’t yet prepared to receive direct HTTP calls, that’s why in the next step, we will install Pluto.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #B392F0">$</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">sh</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">-ci</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"$(</span><span style="color: #B392F0">curl</span><span style="color: #9ECBFF"> </span><span style="color: #79B8FF">-fsSL</span><span style="color: #9ECBFF"> https://smartcontracts.org/install.sh)"</span></span>
<span class="line"><span style="color: #B392F0">$</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">dfx</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">new</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">project-name</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">--no-frontend</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">--type</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">rust</span></span></code></pre>
<p>After initializing the new project, we can set up Pluto in it. To do that, open the created folder containing your project and navigate to the backend part of your project (project-name_backend). Then open the Cargo.toml file and add the Pluto dependency. The file should contain something like this (versions may be newer):</p>
<h3 id="cargotoml">cargo.toml</h3>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">[</span><span style="color: #B392F0">package</span><span style="color: #E1E4E8">]</span></span>
<span class="line"><span style="color: #E1E4E8">name = </span><span style="color: #9ECBFF">"project-name_backend"</span></span>
<span class="line"><span style="color: #E1E4E8">version = </span><span style="color: #9ECBFF">"0.1.0"</span></span>
<span class="line"><span style="color: #E1E4E8">edition = </span><span style="color: #9ECBFF">"2021"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">[</span><span style="color: #B392F0">lib</span><span style="color: #E1E4E8">]</span></span>
<span class="line"><span style="color: #E1E4E8">crate-type = [</span><span style="color: #9ECBFF">"cdylib"</span><span style="color: #E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">[</span><span style="color: #B392F0">dependencies</span><span style="color: #E1E4E8">]</span></span>
<span class="line"><span style="color: #E1E4E8">candid = </span><span style="color: #9ECBFF">"0.8"</span></span>
<span class="line"><span style="color: #E1E4E8">ic-cdk = </span><span style="color: #9ECBFF">"0.7"</span></span>
<span class="line"><span style="color: #E1E4E8">ic-cdk-timers = </span><span style="color: #9ECBFF">"0.1"</span><span style="color: #E1E4E8"> </span><span style="color: #6A737D"># Feel free to remove this dependency if you don't need timers</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">pluto = { git = </span><span style="color: #9ECBFF">"https://github.com/pu0238/pluto.git"</span><span style="color: #E1E4E8"> } </span><span style="color: #6A737D"># &#x3C;- Pluto deps</span></span>
<span class="line"></span></code></pre>
<p>After Pluto installation simply configure package at lib.rs at src directory. Successfully configured file should contain something like below:</p>
<h3 id="librs">lib.rs</h3>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">use</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">std</span><span style="color: #F97583">::</span><span style="color: #B392F0">collections</span><span style="color: #F97583">::</span><span style="color: #B392F0">HashMap</span><span style="color: #E1E4E8">;</span></span>
<span class="line"><span style="color: #F97583">use</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">std</span><span style="color: #F97583">::</span><span style="color: #B392F0">cell</span><span style="color: #F97583">::</span><span style="color: #B392F0">RefCell</span><span style="color: #E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F97583">use</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">ic_cdk_macros</span><span style="color: #F97583">::</span><span style="color: #E1E4E8">{post_upgrade, query, update};</span></span>
<span class="line"><span style="color: #F97583">use</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">pluto</span><span style="color: #F97583">::</span><span style="color: #E1E4E8">{</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #B392F0">http</span><span style="color: #F97583">::</span><span style="color: #E1E4E8">{</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #B392F0">HttpServe</span><span style="color: #E1E4E8">, </span><span style="color: #B392F0">RawHttpRequest</span><span style="color: #E1E4E8">, </span><span style="color: #B392F0">RawHttpResponse</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #B392F0">HttpRequest</span><span style="color: #E1E4E8">, </span><span style="color: #B392F0">HttpResponse</span></span>
<span class="line"><span style="color: #E1E4E8">    },</span></span>
<span class="line"><span style="color: #E1E4E8">    http_serve,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #B392F0">router</span><span style="color: #F97583">::</span><span style="color: #B392F0">Router</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">};</span></span>
<span class="line"><span style="color: #F97583">use</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">serde_json</span><span style="color: #F97583">::</span><span style="color: #E1E4E8">json;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// Build routes</span></span>
<span class="line"><span style="color: #F97583">fn</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">setup_routes</span><span style="color: #E1E4E8">() {</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">let</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">mut</span><span style="color: #E1E4E8"> router </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">Router</span><span style="color: #F97583">::</span><span style="color: #B392F0">new</span><span style="color: #E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">    router</span><span style="color: #F97583">.</span><span style="color: #B392F0">get</span><span style="color: #E1E4E8">(</span><span style="color: #9ECBFF">"/"</span><span style="color: #E1E4E8">, </span><span style="color: #79B8FF">false</span><span style="color: #E1E4E8">, </span><span style="color: #F97583">|</span><span style="color: #E1E4E8">_req</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">HttpRequest</span><span style="color: #F97583">|</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">async</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">move</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #B392F0">Ok</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">HttpResponse</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">            status_code</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">200</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">            headers</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">HashMap</span><span style="color: #F97583">::</span><span style="color: #B392F0">new</span><span style="color: #E1E4E8">(),</span></span>
<span class="line"><span style="color: #E1E4E8">            body</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">json!</span><span style="color: #E1E4E8">({</span></span>
<span class="line"><span style="color: #E1E4E8">                </span><span style="color: #9ECBFF">"statusCode"</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">200</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                </span><span style="color: #9ECBFF">"message"</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Hello World from GET"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">            })</span></span>
<span class="line"><span style="color: #E1E4E8">            </span><span style="color: #F97583">.</span><span style="color: #B392F0">into</span><span style="color: #E1E4E8">(),</span></span>
<span class="line"><span style="color: #E1E4E8">        })</span></span>
<span class="line"><span style="color: #E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">    router</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #B392F0">thread_local!</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #6A737D">    // Router storage that contains cached routes</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">static</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">ROUTER</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RefCell</span><span style="color: #E1E4E8">&#x3C;</span><span style="color: #B392F0">Router</span><span style="color: #E1E4E8">>  </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RefCell</span><span style="color: #F97583">::</span><span style="color: #B392F0">new</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">setup_routes</span><span style="color: #E1E4E8">());</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// System functions</span></span>
<span class="line"><span style="color: #E1E4E8">#[post_upgrade]</span></span>
<span class="line"><span style="color: #F97583">fn</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">post_upgrade</span><span style="color: #E1E4E8">() {</span></span>
<span class="line"><span style="color: #6A737D">    // After update rebuild routes</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #79B8FF">ROUTER</span><span style="color: #F97583">.</span><span style="color: #B392F0">with</span><span style="color: #E1E4E8">(</span><span style="color: #F97583">|</span><span style="color: #E1E4E8">r</span><span style="color: #F97583">|</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">*</span><span style="color: #E1E4E8">r</span><span style="color: #F97583">.</span><span style="color: #B392F0">borrow_mut</span><span style="color: #E1E4E8">() </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">setup_routes</span><span style="color: #E1E4E8">())</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// Http interface</span></span>
<span class="line"><span style="color: #E1E4E8">#[query]</span></span>
<span class="line"><span style="color: #F97583">async</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">fn</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">http_request</span><span style="color: #E1E4E8">(req</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpRequest</span><span style="color: #E1E4E8">) </span><span style="color: #F97583">-></span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpResponse</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #B392F0">bootstrap</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">http_serve!</span><span style="color: #E1E4E8">(), req)</span><span style="color: #F97583">.await</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">#[update]</span></span>
<span class="line"><span style="color: #F97583">async</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">fn</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">http_request_update</span><span style="color: #E1E4E8">(req</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpRequest</span><span style="color: #E1E4E8">) </span><span style="color: #F97583">-></span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpResponse</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #B392F0">bootstrap</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">http_serve!</span><span style="color: #E1E4E8">(), req)</span><span style="color: #F97583">.await</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// Main functions that handle routing</span></span>
<span class="line"><span style="color: #F97583">async</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">fn</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">bootstrap</span><span style="color: #E1E4E8">(</span><span style="color: #F97583">mut</span><span style="color: #E1E4E8"> app</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">HttpServe</span><span style="color: #E1E4E8">, req</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpRequest</span><span style="color: #E1E4E8">) </span><span style="color: #F97583">-></span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpResponse</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">let</span><span style="color: #E1E4E8"> router </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">ROUTER</span><span style="color: #F97583">.</span><span style="color: #B392F0">with</span><span style="color: #E1E4E8">(</span><span style="color: #F97583">|</span><span style="color: #E1E4E8">r</span><span style="color: #F97583">|</span><span style="color: #E1E4E8"> r</span><span style="color: #F97583">.</span><span style="color: #B392F0">borrow</span><span style="color: #E1E4E8">()</span><span style="color: #F97583">.</span><span style="color: #B392F0">clone</span><span style="color: #E1E4E8">());</span></span>
<span class="line"><span style="color: #E1E4E8">    app</span><span style="color: #F97583">.</span><span style="color: #B392F0">set_router</span><span style="color: #E1E4E8">(router);</span></span>
<span class="line"><span style="color: #E1E4E8">    app</span><span style="color: #F97583">.</span><span style="color: #B392F0">serve</span><span style="color: #E1E4E8">(req)</span><span style="color: #F97583">.await</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span></code></pre>
<p>Run configured canister using below commands:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #B392F0">dfx</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">start</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">--background</span></span>
<span class="line"><span style="color: #B392F0">dfx</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">deploy</span></span></code></pre>
<p>After deploy we may find in console link to candid ui:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #e1e4e8">http://asrmz-lmaaa-aaaaa-qaaeq-cai.localhost:4943/?id=by6od-j4aaa-aaaaa-qaadq-cai</span></span>
<span class="line"><span style="color: #e1e4e8">      |___________________________|                  |___________________________|</span></span>
<span class="line"><span style="color: #e1e4e8">           Candid canister ID                             Backend canister ID</span></span></code></pre>
<p>To access canister HTTP interface replace “backend-canister-id” with your backend canister ID from above and go to: <a href="http://backend-carnister-id.localhost:4943/">http://backend-carnister-id.localhost:4943/</a></p>
<p>At given link you should find response from your HTTP server.</p>
        </div>
        <div class="grid text-center sm:flex sm:justify-between pt-2 sm:pt-10 pb-2 border-b-[1px]">
          <p>Published at: 2024-01-25</p>

          <p>Written by: Pu0238</p>
        </div>
      </div>

      <div class="pt-10 min-w-[150px] pl-5 hidden md:block">
        <astro-island uid="Z1tnzVB" component-url="/_astro/Minimap.ad6fb8d7.js" component-export="default" renderer-url="/_astro/client.537fc49b.js" props="{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;introduction&quot;],&quot;text&quot;:[0,&quot;Introduction&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;idea&quot;],&quot;text&quot;:[0,&quot;Idea&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;installation&quot;],&quot;text&quot;:[0,&quot;Installation&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cargotoml&quot;],&quot;text&quot;:[0,&quot;cargo.toml&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;librs&quot;],&quot;text&quot;:[0,&quot;lib.rs&quot;]}]]]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Minimap&quot;,&quot;value&quot;:true}"></astro-island>
      </div>
    </section>
  </div>

  </body></html>