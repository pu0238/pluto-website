<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="Pluto is decentralized HTTP router designed on Internet Computer to allow users to create decentralized rest-api infrastructure.">
  <meta name="robots" content="index, follow">
  <meta property="og:title" content="Pluto - decentralized HTTP router">
  <meta property="og:url" content="https://t5mcf-cqaaa-aaaag-qcjna-cai.raw.icp0.io/">
  <meta property="og:description" content="Pluto is decentralized HTTP router designed on Internet Computer to allow users to create decentralized rest-api infrastructure.">
  <meta property="og:type" content="website">

  <link rel="stylesheet" href="/styles/style.css">
  <link rel="stylesheet" href="/styles/fonts.css">

 

  <title>Pluto - decentralized HTTP router</title>

  <script lang="js" src="js/smooth_scroll.js">
    
  </script>
<link rel="stylesheet" href="/_astro/SUMMARY.68b3370a.css" />
<link rel="stylesheet" href="/_astro/Minimap.a2345f3b.css" /></head>
  <body>
    
  <div class="container mx-auto">
    <nav class="mx-8 my-0 sm:my-4">
      <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var d;{let p={0:t=>u(t),1:t=>l(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(l(t)),5:t=>new Set(l(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},h=t=>{let[e,n]=t;return e in p?p[e](n):void 0},l=t=>t.map(h),u=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,h(n)]));customElements.get("astro-island")||customElements.define("astro-island",(d=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=async()=>{var i;if(!this.hydrator||!this.isConnected)return;let e=(i=this.parentElement)==null?void 0:i.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),o={},a=this.querySelectorAll("template[data-astro-template]");for(let r of a){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(o[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of n){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(o[r.getAttribute("name")||"default"]=r.innerHTML)}let c;try{c=this.hasAttribute("props")?u(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}await this.hydrator(this)(this.Component,c,o,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((e,n)=>{n.disconnect(),setTimeout(()=>this.childrenConnectedCallback(),0)}).observe(this,{childList:!0})}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}Astro[n](async()=>{let o=this.getAttribute("renderer-url"),[a,{default:c}]=await Promise.all([import(this.getAttribute("component-url")),o?import(o):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(let r of i.split("."))this.Component=this.Component[r]}return this.hydrator=c,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},d.observedAttributes=["props"],d))}})();</script><astro-island uid="7nuyM" component-url="/_astro/NavBar.5d5d8abf.js" component-export="default" renderer-url="/_astro/client.537fc49b.js" props="{&quot;searchData&quot;:[1,[[0,{&quot;title&quot;:[0,&quot;Advanced Topics&quot;],&quot;headings&quot;:[1,[]],&quot;url&quot;:[0,&quot;/docs/advanced&quot;]}],[0,{&quot;title&quot;:[0,&quot;Setting Up the Project&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;setting-up-the-project&quot;],&quot;text&quot;:[0,&quot;Setting up the project&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;server-setup&quot;],&quot;text&quot;:[0,&quot;Server setup&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/advanced/one&quot;]}],[0,{&quot;title&quot;:[0],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;getting-started&quot;],&quot;text&quot;:[0,&quot;Getting Started&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;tools-and-requirements&quot;],&quot;text&quot;:[0,&quot;Tools and Requirements&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;rust&quot;],&quot;text&quot;:[0,&quot;Rust&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;internet-computer-tooling&quot;],&quot;text&quot;:[0,&quot;Internet Computer tooling&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;other-requirements&quot;],&quot;text&quot;:[0,&quot;Other requirements&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/getting_started&quot;]}],[0,{&quot;title&quot;:[0,&quot;Running the Examples&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;core-features-of-pluto&quot;],&quot;text&quot;:[0,&quot;Core features of Pluto&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;cloning-the-repository&quot;],&quot;text&quot;:[0,&quot;Cloning the repository&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;accessing-the-canisters-through-http&quot;],&quot;text&quot;:[0,&quot;Accessing the canisters through HTTP&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/getting_started/runing_examples&quot;]}],[0,{&quot;title&quot;:[0],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;introduction&quot;],&quot;text&quot;:[0,&quot;Introduction&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;idea&quot;],&quot;text&quot;:[0,&quot;Idea&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;installation&quot;],&quot;text&quot;:[0,&quot;Installation&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cargotoml&quot;],&quot;text&quot;:[0,&quot;cargo.toml&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;librs&quot;],&quot;text&quot;:[0,&quot;lib.rs&quot;]}]]],&quot;url&quot;:[0,&quot;/docs&quot;]}],[0,{&quot;title&quot;:[0],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;overview&quot;],&quot;text&quot;:[0,&quot;Overview&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;input-methods&quot;],&quot;text&quot;:[0,&quot;Input methods:&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;routing&quot;],&quot;text&quot;:[0,&quot;Routing&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/overview&quot;]}],[0,{&quot;title&quot;:[0,&quot;Building REST APIs&quot;],&quot;headings&quot;:[1,[]],&quot;url&quot;:[0,&quot;/docs/rest_apis&quot;]}],[0,{&quot;title&quot;:[0,&quot;Setting Up the Project&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;setting-up-the-project&quot;],&quot;text&quot;:[0,&quot;Setting up the project&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;server-setup&quot;],&quot;text&quot;:[0,&quot;Server setup&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/rest_apis/one&quot;]}],[0,{&quot;title&quot;:[0,&quot;Adding CORS&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;bootstraping-cors&quot;],&quot;text&quot;:[0,&quot;Bootstraping CORS&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/rest_apis/three&quot;]}],[0,{&quot;title&quot;:[0,&quot;Adding Body Validation&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;adding-an-addition-endpoint&quot;],&quot;text&quot;:[0,&quot;Adding an addition endpoint&quot;]}]]],&quot;url&quot;:[0,&quot;/docs/rest_apis/two&quot;]}]]]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;NavBar&quot;,&quot;value&quot;:true}"></astro-island>
    </nav>
    <section class="sm:flex">
      <section>
  <div class="sm:pl-1">
    <astro-island uid="Z1PNlAy" component-url="/_astro/Menu.daa14378.js" component-export="default" renderer-url="/_astro/client.537fc49b.js" props="{&quot;summaryContent&quot;:[0,&quot;&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs\&quot;&gt;INTRODUCTION&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/overview\&quot;&gt;OVERVIEW&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/getting_started\&quot;&gt;GETTING STARTED&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/getting_started/runing_examples.md\&quot;&gt;Running the Examples&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/\&quot;&gt;BUILDING REST APIS&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/one\&quot;&gt;Project Setup&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/two\&quot;&gt;Body Validation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/docs/rest_apis/three\&quot; class=\&quot;text-greenAccent-500\&quot;&gt;CORS support&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;&quot;]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Menu&quot;,&quot;value&quot;:true}"></astro-island>
  </div>
</section>
      <div class="docView grow md:p-2 lg:p-5 sm:px-2 md:px-5 lg:px-20 overflow-x-hidden">
        <h1>Adding CORS</h1>
        <div class="docMargin min-h-screen ">
          <p>We often face issues where we don’t want our backend to be called from just any old website. That is why we decided to implement CORS helper methods into Pluto. In this section we’re going to quickly go over the steps to add CORS to our server.</p>
<h2 id="bootstraping-cors">Bootstraping CORS</h2>
<p>To add CORS module, let’s open the <code>bootstrap.rs</code> file and modify the <code>bootstrap()</code> method accordingly:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">async</span><span style="color: #E1E4E8"> </span><span style="color: #F97583">fn</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">bootstrap</span><span style="color: #E1E4E8">(</span><span style="color: #F97583">mut</span><span style="color: #E1E4E8"> app</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">HttpServe</span><span style="color: #E1E4E8">, req</span><span style="color: #F97583">:</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpRequest</span><span style="color: #E1E4E8">) </span><span style="color: #F97583">-></span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">RawHttpResponse</span><span style="color: #E1E4E8"> {</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">let</span><span style="color: #E1E4E8"> router </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">ROUTER</span><span style="color: #F97583">.</span><span style="color: #B392F0">with</span><span style="color: #E1E4E8">(</span><span style="color: #F97583">|</span><span style="color: #E1E4E8">r</span><span style="color: #F97583">|</span><span style="color: #E1E4E8"> r</span><span style="color: #F97583">.</span><span style="color: #B392F0">borrow</span><span style="color: #E1E4E8">()</span><span style="color: #F97583">.</span><span style="color: #B392F0">clone</span><span style="color: #E1E4E8">());</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #F97583">let</span><span style="color: #E1E4E8"> cors </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">Cors</span><span style="color: #F97583">::</span><span style="color: #B392F0">new</span><span style="color: #E1E4E8">()</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #F97583">.</span><span style="color: #B392F0">allow_origin</span><span style="color: #E1E4E8">(</span><span style="color: #9ECBFF">"*"</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #F97583">.</span><span style="color: #B392F0">allow_methods</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">vec!</span><span style="color: #E1E4E8">[</span><span style="color: #B392F0">Method</span><span style="color: #F97583">::</span><span style="color: #79B8FF">POST</span><span style="color: #E1E4E8">, </span><span style="color: #B392F0">Method</span><span style="color: #F97583">::</span><span style="color: #79B8FF">PUT</span><span style="color: #E1E4E8">])</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #F97583">.</span><span style="color: #B392F0">allow_headers</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">vec!</span><span style="color: #E1E4E8">[</span><span style="color: #9ECBFF">"Content-Type"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">"Authorization"</span><span style="color: #E1E4E8">])</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #F97583">.</span><span style="color: #B392F0">max_age</span><span style="color: #E1E4E8">(</span><span style="color: #B392F0">Some</span><span style="color: #E1E4E8">(</span><span style="color: #79B8FF">3600</span><span style="color: #E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">    app</span><span style="color: #F97583">.</span><span style="color: #B392F0">set_router</span><span style="color: #E1E4E8">(router);</span></span>
<span class="line"><span style="color: #E1E4E8">    app</span><span style="color: #F97583">.</span><span style="color: #B392F0">use_cors</span><span style="color: #E1E4E8">(cors);</span></span>
<span class="line"><span style="color: #E1E4E8">    app</span><span style="color: #F97583">.</span><span style="color: #B392F0">serve</span><span style="color: #E1E4E8">(req)</span><span style="color: #F97583">.await</span></span>
<span class="line"><span style="color: #E1E4E8">}</span></span></code></pre>
<p>With the addition of the <code>Cors</code> struct we can now restrict our origin policy in any way we would like. That’s it, nothing else is required beyond these few lines of code. Now the appropriate headers will be added to every preflight request.</p>
        </div>
        <div class="grid text-center sm:flex sm:justify-between pt-2 sm:pt-10 pb-2 border-b-[1px]">
          <p>Published at: 2024-01-29</p>

          <p>Written by: Reyth</p>
        </div>
      </div>

      <div class="pt-10 min-w-[150px] pl-5 hidden md:block">
        <astro-island uid="Z2r83Jr" component-url="/_astro/Minimap.ad6fb8d7.js" component-export="default" renderer-url="/_astro/client.537fc49b.js" props="{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;bootstraping-cors&quot;],&quot;text&quot;:[0,&quot;Bootstraping CORS&quot;]}]]]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Minimap&quot;,&quot;value&quot;:true}"></astro-island>
      </div>
    </section>
  </div>

  </body></html>